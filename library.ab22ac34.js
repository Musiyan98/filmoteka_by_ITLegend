const e=document.querySelector(".mask");window.addEventListener("DOMContentLoaded",(function(){setTimeout((()=>{e.classList.add("hide")}),600)}));const t={formEl:document.querySelector(".form"),inputEl:document.querySelector(".input__form"),buttonEl:document.querySelector(".submit"),error:document.querySelector(".error__message"),enLang:document.querySelector(".en"),ukLang:document.querySelector(".uk"),header:document.querySelector(".header")};t.enLang.addEventListener("click",(()=>{t.enLang.classList.add("activeLang"),t.ukLang.classList.remove("activeLang")})),t.ukLang.addEventListener("click",(()=>{t.ukLang.classList.add("activeLang"),t.enLang.classList.remove("activeLang")}));try{t.formEl.addEventListener("submit",(function(e){e.preventDefault();const a=e.currentTarget.elements[0].value;t.error.style.display="none",""==a&&(t.error.style.display="block");e.currentTarget.reset()}))}catch(e){console.log(e)}const a={watched:document.querySelector(".watched"),queue:document.querySelector(".queue"),enLang:document.querySelector(".en"),ukLang:document.querySelector(".uk")};a.enLang.addEventListener("click",(()=>{a.enLang.classList.add("activeLang"),a.ukLang.classList.remove("activeLang")})),a.ukLang.addEventListener("click",(()=>{a.ukLang.classList.add("activeLang"),a.enLang.classList.remove("activeLang")}));try{a.watched.addEventListener("click",(()=>{a.watched.classList.add("active"),a.queue.classList.remove("active")}))}catch(e){console.log(e)}try{a.queue.addEventListener("click",(()=>{a.queue.classList.add("active"),a.watched.classList.remove("active")}))}catch(e){console.log(e)}async function n(e,t){try{const a="https://api.themoviedb.org/3/search/movie";return(await fetch(`${a}?api_key=1c5c067e324c39f9223ad13ef9891a0a&page=${t}&query=${e}`)).json()}catch(e){console.error(e)}}async function o(e){try{console.log(e);const t="https://api.themoviedb.org/3/movie/";return(await fetch(`${t}${e}?api_key=1c5c067e324c39f9223ad13ef9891a0a`)).json()}catch(e){console.error(e)}}const c=document.querySelector(".gallery"),r=localStorage.getItem("currentArrayFilm");JSON.parse(r);var s=function(e){const t=e.map((e=>{const{title:t,genresName:a,release_date:n,id:o,poster_path:c}=e;return`<li class="gallery__item">\n            <a class="gallery__card" href="#" id="${o}">\n               <picture>\n                  <source media="(min-width: 1280px)" srcset="\n                              https://image.tmdb.org/t/p/w500${c}    1x,\n                              https://image.tmdb.org/t/p/original${c} 2x,\n                              https://image.tmdb.org/t/p/original${c} 3x\n                           " type="image/jpg" />\n                  <source media="(min-width: 768px)" srcset="\n                              https://image.tmdb.org/t/p/w342${c}    1x,\n                              https://image.tmdb.org/t/p/w780${c} 2x,\n                              https://image.tmdb.org/t/p/original${c} 3x\n                           " type="image/jpg" />\n                  <source media="(max-width: 767px)" srcset="\n                              https://image.tmdb.org/t/p/w342${c}    1x,\n                              https://image.tmdb.org/t/p/w780${c} 2x,\n                              https://image.tmdb.org/t/p/original${c} 3x\n                           " type="image/jpg" />\n                  <img class="gallery__foto" src="https://image.tmdb.org/t/p/w500${c}" width="450"\n                     height="294" alt="${t} poster" loading="lazy" />\n               </picture>\n               <h2 class="gallery__subtitle">${t}</h2>\n               <div class="gallery__info">\n                  <p class="gallery__genres">${a}</p>\n                  <p class="gallery__year">${n.slice(0,4)}</p>\n               </div>\n            </a>\n         </li>`})).join("");c.insertAdjacentHTML("beforeend",t)};const i=document.querySelector(".gallery"),l=document.querySelector(".form"),d=document.querySelector(".error__message");l&&(l.addEventListener("input",(function(e){u=e.target.value})),l.addEventListener("submit",(function(e){e.preventDefault(),i.innerHTML="",n(u,1).then((e=>{p(e)}))})));let u="",g=[];(async function(){try{const e="https://api.themoviedb.org/3/genre/movie/list";return(await fetch(`${e}?api_key=1c5c067e324c39f9223ad13ef9891a0a`)).json()}catch(e){console.error(e)}})().then((e=>{localStorage.setItem("Genres",JSON.stringify(e.genres))}));localStorage.getItem("Genres");const m=localStorage.getItem("currentArrayFilm");JSON.parse(m);function p(e){const t=e.results;e.total_results,e.total_pages;let a=function(e){g=[];e.map((e=>{g.push(e)}));if(0==g.length)return d.style.display="block",JSON.parse(localStorage.getItem("currentArrayFilm"));let t=function(e){return e.map((e=>{return(t=e).genresName=function(e){let t="";const a=localStorage.getItem("Genres"),n=JSON.parse(a);return 0!==e.length&&(e.length>3&&(e=e.slice(0,3)),Object.values(n).forEach((a=>{e.includes(a.id)&&(t=t.concat(a.name,", "))}))),t=t.slice(0,t.length-2),t}(t.genre_ids),t;var t}))}(g);return localStorage.setItem("currentArrayFilm",JSON.stringify(t)),t}(t);s(a)}(async function(e){try{const t="https://api.themoviedb.org/3/trending/movie/week";return(await fetch(`${t}?api_key=1c5c067e324c39f9223ad13ef9891a0a&page=${e}`)).json()}catch(e){console.error(e)}})(1).then((e=>{p(e)})).catch((e=>{console.log(e)}));document.querySelector(".gallery-lib"),document.querySelector(".div__text--decoration");const v=document.querySelector(".gallery"),y=document.querySelector(".modal"),h=document.querySelector(".button-modal__close");async function _(e,t,a){a.preventDefault();let n=localStorage.getItem(t);try{n=JSON.parse(n),Array.isArray(n)||(n=[])}catch{n=[]}const o="films-to-watched"===t?"to the watched":"to the queue";for(valueFilm of n)if(valueFilm.id===e.id)return void window.alert(`This film has already been added ${o}!`);n.push(e),window.alert(`New film ${e.title} added ${o}!`),localStorage.setItem(t,JSON.stringify(n)),console.dir(n)}async function b(e){let t=e.target.dataset.id;console.log(e.target.dataset.id);let a=await async function(e){return await o(e).then((e=>{localStorage.setItem("IMDb_id",JSON.stringify(e.imdb_id))})),await JSON.parse(localStorage.getItem("IMDb_id"))}(t),n=`https://www.imdb.com/title/${a}`;console.log(window.open(n))}v&&(v.addEventListener("click",(function(e){if(e.target===e.currentTarget)return;e.preventDefault();let t=(a=e.target.closest(".gallery__card").id,function(){let e=localStorage.getItem("currentArrayFilm");return JSON.parse(e)}().find((e=>e.id===Number(a))));var a;(function(e,t){const{id:a,title:n,original_title:o,poster_path:c,popularity:r,vote_average:s,vote_count:i,overview:l,genresName:d}=e;let u=`    \n        <div class="button-modal--flex">\n            <img class="button-modal__img" src="https://image.tmdb.org/t/p/original${c}" alt="${n} poster">\n            <div class="modal__about--movie">\n                <h2 class="modal__about--title">${n}</h2>\n                <p class="modal__about--title--movie">Vote / Votes <span class="modal__about--rating">${s}</span><span\n\n                        class="modal__about--title--movie-slech">/</span> <span\n                        class="modal__about--text--bleck">${i}</span>\n                        </p>\n                        <button class="imdb-btn" data-id="${a}" type="button">IMDb</button>\n                <p class="modal__about--title--movie">Popularity<span\n                        class="modal__about--text--popularity">${r}</span>\n                <p class="modal__about--title--movie">Original Title<span class="modal__about--text--original--title">A\n                        ${o}</span>\n                <p class="modal__about--title--movie">Genre<span class="modal__about--text--genre">${d}</span>\n                </p>\n                </p>\n                <p class="about__movie--text">About</p>\n                <p class="about__movie--text--content">${l}</p>\n                <ul class="list__btn--add">\n                    <li><button class="add__watched" data-id="${a}" type="button">add to Watched</button></li>\n                    <li><button class="add_queue" data-id="${a}" type="button">add to queue</button></li>\n                </ul>\n\n            </div>\n        </div>\n    </div>`;y.insertAdjacentHTML("beforeend",u)})(t),document.querySelector(".backdrop").classList.remove("display__none");const n=document.querySelector(".add__watched"),o=document.querySelector(".add_queue");document.querySelector(".imdb-btn").addEventListener("click",b),n.addEventListener("click",_.bind(this,t,"films-to-watched")),o.addEventListener("click",_.bind(this,t,"films-to-queue"))})),h.addEventListener("click",(function(e){const t=document.querySelector(".add__watched"),a=document.querySelector(".add_queue");document.querySelector(".imdb-btn").removeEventListener("click",b),t.removeEventListener("click",_),a.removeEventListener("click",_),document.querySelector(".backdrop").classList.add("display__none"),document.querySelector(".button-modal--flex").remove(),localStorage.removeItem("IMDb_id")})));const f=document.querySelector(".pagination ul");f.innerHTML=function(e,t){let a,n="",o=t-1,c=t+1;t>1&&(n+=`<li class="btn-skip prev" onclick="createPagination(totalPages, ${t-1})"><span><i class="left"></i>\n    \n    <svg class="svg-btn" width="16"  height="16">\n    <use href="images/svg-pag.svg#icon-arrowleft">\n    </use>\n  </svg>\n  \n  </span></li>`);t>2&&(n+='<li class="first numb" onclick="createPagination(totalPages, 1)"><span>1</span></li>',t>3&&(n+='<li class="dots"><span>...</span></li>'));t==e?o-=2:t==e-1&&(o-=1);1==t?c+=2:2==t&&(c+=1);for(var r=o;r<=c;r++)r>e||(0==r&&(r+=1),a=t==r?"active":"",n+=`<li class="numb ${a}" onclick="createPagination(totalPages, ${r})"><span>${r}</span></li>`);t<e-1&&(t<e-2&&(n+='<li class="dots"><span>...</span></li>'),n+=`<li class="last numb" onclick="createPagination(totalPages, ${e})"><span>${e}</span></li>`);t<e&&(n+=`<li class="btn-skip next" onclick="createPagination(totalPages, ${t+1})"><span> \n    <svg class="svg-btn" width="16"  height="16">\n    <use href="images/svg-pag.svg#icon-arrowright">\n    </use>\n  </svg> \n <i class="right"></i></span></li>`);return f.innerHTML=n,n}(20,15);var L={};const S=document.querySelector(".watched"),w=document.querySelector(".queue");function q(e,t){t.preventDefault();const a=localStorage.getItem(e);try{const e=JSON.parse(a);console.log(e)}catch{console.log("Не получилось распарсить JSON"),console.log(a)}}S&&S.addEventListener("click",q.bind(L,"films-to-watched")),w&&w.addEventListener("click",q.bind(L,"films-to-queue"));
//# sourceMappingURL=library.ab22ac34.js.map
